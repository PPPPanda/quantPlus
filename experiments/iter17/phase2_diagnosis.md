# iter17 Phase 2: 失败模式分解

## 核心发现

### 1. 短持仓胜率随时间递增

| 持仓时长 | 交易数 | PnL | 胜率 |
|---------|--------|-----|------|
| **<5 bars** | 30 | -920 | **0%** |
| 5-10 bars | 16 | -394 | 12.5% |
| 10-20 bars | 14 | -380 | 28.6% |
| 20-50 bars | 19 | -124 | 42.1% |
| >50 bars | 162 | +5816 | 55.6% |

### 2. 失败模式识别

**FM-1: 极短持仓全亏（<5 bars，胜率 0%）**
- 30 笔交易全部亏损
- 原因：入场后立即被反向打穿止损
- 当前 `min_hold_bars=2` 太短

**FM-2: 入场位置无明显规律**
- Low/Mid/High 胜率差异不大（14-25%）
- 说明问题不在入场位置，而在**止损过早**

**FM-3: 合约差异**
- p2201: 25 笔短持仓，胜率 8%（最差）
- p2209: 29 笔短持仓，胜率 27.6%（相对较好）
- p2401: 25 笔短持仓，胜率 16%

### 3. 根因分析

```
入场 → 正常回撤 → 触发止损（<5 bars）→ 亏损
                    ↓
        问题：止损距离/保护时间不够
```

当前参数：
- `min_hold_bars=2`：开仓后 2 根 5m bar 止损加倍
- 但 <5 bars 胜率 0% 说明 2 bars 不够

## 修复方向

### 方向 1：增加最小持仓保护时间
```python
min_hold_bars: 2 → 5 或 10
```
预期：减少极短持仓亏损，给信号更多验证时间

### 方向 2：分阶段止损保护
```python
# 当前：前 2 bars 止损距离 ×2
# 改进：前 5 bars ×2，5-10 bars ×1.5
```

### 方向 3：入场延迟确认
信号生成后等待 1-2 根 5m bar 确认后再入场

## 优先级排序

| 方向 | 改动半径 | 预期影响 | 优先级 |
|------|---------|----------|--------|
| 增加 min_hold_bars | 低 | 减少极短持仓亏损 | ⭐⭐⭐ |
| 分阶段止损保护 | 中 | 更精细的风控 | ⭐⭐ |
| 入场延迟确认 | 中 | 减少假信号 | ⭐ |

## Phase 2 结论

**核心问题**：极短持仓（<5 bars）胜率 0%，是主要亏损来源

**根因**：`min_hold_bars=2` 太短，正常回撤就被止损

**修复方案**：增加 `min_hold_bars` 到 5-10
