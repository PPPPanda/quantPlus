# Iteration 5 综合分析报告

## 输入来源
1. **Claude 自主诊断** (`iter5_claude_diagnosis.md`)：3 个问题合约的深度数据分析
2. **GPT-5.2 研究协调** (`iter5_gpt52_analysis.md`)：Phase 1 v2 审计 + 6 个新 Phase 3 方案
3. **GPT-5.2 诊断代理** (`iter5_diagnosis.md`)：P2401/P2601 逐笔交易归因

## GPT-5.2 的核心洞察（Phase 1 v2）

**为什么"修正缠论偏差"反而变差：**
原版非标实现的可交易性不来自缠论定义正确，而来自：
1. **短记忆动态箱体（滑动中枢）**捕捉震荡回归
2. **动量型 2B/2S**（不是真背驰）捕捉趋势延续
3. 缺乏结构化出场，依赖"信号频率 + 止损"塑造收益分布

→ 结论：**不要把策略"修正成缠论"，而是把非标实现背后的统计优势结构化**

## Iter5 实验结果（38 个配置）

### 排名 Top 10
| # | 配置 | Score | Total | Min | ≥800 |
|---|------|-------|-------|-----|------|
| 1 | S1_anchor_uni_bg5 | 818 | 4725 | 143 | 1/7 |
| 2 | REF_v4best | 815 | 4702 | 143 | 1/7 |
| 3-7 | S1_int/S3_density variants | 815 | 4702 | 143 | 1/7 |
| 8 | S5_vol_1.0_bg5 | 815 | 4702 | 143 | 1/7 |
| 9 | TS_50_bg5 | 815 | 4702 | 143 | 1/7 |
| 10 | S5_vol_1.5_bg5 | 815 | 4702 | 143 | 1/7 |

### 各策略效果评估

**S1 Anchored Pivot（锚定中枢）**：
- intersect 模式 bg5: 与 v4best 完全相同 → 说明 bg5 下中枢重叠不多，合并无效
- union 模式 bg5: 微小改善（P2401 不变，P2405 +23）
- bg7: 与 v1best 基本相同
- **结论：锚定中枢在 bg5 下无明显效果，因为 bi_amp_filter 已经减少了伪中枢**

**S2 Regime Switch（震荡/趋势双模）**：
- bg5 下严重伤害收益（总 PnL 从 4702 降到 ~1500）
- **2B/2S 被大量禁止** → P2509 从 637 降到 120-141，P2205 从 2211 降到 482
- bg4 下更糟：P2201 暴跌到 -655
- **结论：Regime Switch 过于激进，80%+ 的 pivot 都重叠（审计已知），导致几乎全程处于 "range" 模式，2B/2S 几乎被全面禁止**

**S3 Bi Density Adaptive（结构密度自适应）**：
- 所有 density 阈值（0.10-0.18）与 v4best 完全相同
- **结论：在 bg5 + bi_amp_filter 下，密度阈值没有被触发。这些过滤器已经将密度降到阈值以下了**

**S4 MACD Slope Filter（MACD 斜率）**：
- bg5: P2401 改善显著（-143→-30），但 P2201 崩溃（234→-228）
- bg7: P2401 仍负（-137），P2601 也变负（71→-40）
- **结论：MACD slope 在某些合约有效但在其他合约有害，不是通用改善**

**S5 Volume Confirm（量能确认）**：
- vol_mult=1.0/1.5: 与 v4best 完全相同（成交量信息可能都是 0 或相同？）
- vol_mult=1.2: 微小改善 bg5，bg7 下 P2401 仍负
- **结论：数据中的成交量信息可能不充分或不可靠**

**Time Stop（时间止损）**：
- 30 bar: P2509 微小改善（644 vs 637），其他不变
- 50 bar: 与 v4best 完全相同
- **结论：大部分交易在 30 bar 内已经结束了**

**组合策略**：
- anchor + regime: 严重伤害（和 S2 一样的问题）
- anchor + slope: 与单独 slope 相同
- FULL: 被 regime switch 拖累

## 核心问题诊断

### 为什么 5 个新策略都不起作用？

1. **Regime Switch 的阈值问题**：审计发现 80%+ pivot 重叠 → 任何合理阈值都会把大部分时间判为"range"→ 2B/2S 被全面封杀 → 收益崩溃。需要更精细的阈值或更局部的重叠定义。

2. **Density/Volume/TimeStop 在现有过滤器下无效**：bi_amp_filter + macd_consistency 已经把噪声交易减少到很低水平，追加过滤器几乎没有额外空间。

3. **Anchor Pivot 效果被 bi_amp_filter 掩盖**：bi_amp_filter ≥ 1.5 ATR 已经间接稳定了中枢（大笔运动自然减少伪中枢频率），所以显式的 anchor 合并无增量。

4. **MACD slope 是双刃剑**：它在 P2401 上修正了"追衰退反弹"的问题，但在 P2201 上让正常信号也被过度过滤。

### 根本矛盾仍未解决

| 合约 | 需要 | 当前状态 |
|------|------|---------|
| P2401 | 抑制 2B 追多 | 任何有效抑制都同时伤害其他合约的 2B |
| P2601 | 低 bi_gap 保留信号 | 低 bi_gap 让 P2201/P2401 暴露更多噪声 |
| P2201 | 某种方式修正 15m MACD | MACD slope 修正在这里反而变差 |

## 下一步方向建议

### 方向 A：放弃"统一参数"约束
- 允许 2-3 组参数分别适配"趋势型合约"和"震荡型合约"
- 按合约特征自动分组（可用历史 ADX/波动率分位来分类）
- 这是最实际的路径，因为数据表明不同合约对结构粒度有根本性不同的需求

### 方向 B：更根本的信号改造
- 不是在现有信号上加过滤器，而是改变 2B 的定义本身
- 例如：2B 做多不要求"动量加速"，改为"在上升趋势的回调底部做多"（需要定义什么是"上升趋势"和"回调底部"的量化标准）
- 但这基本等于写一个全新策略

### 方向 C：接受部分合约无法达标
- 当前最佳配置已经实现 7/7 全正（bg5_amp1.5_mc3_grid: min=143）
- 将目标从"每个 ≥ 800"降低到"每个 ≥ 0 且总 ≥ 4000"
- 当前已达成此目标（总 4702，min 143）

### 方向 D：针对 P2401 做特殊处理
- GPT-5.2 诊断代理的关键发现：P2401 的亏损来自 2B "chase_stop"（快速止损）和 "slow_bleed"（长时间钝刀割肉）
- 可以只对 2B 信号加入"入场后 N 根内必须盈利 X ATR，否则退出"的快速止损
- 这不是时间止损（已试过无效），而是"进展止损"（progress stop）
