# iter5 Phase 1: 结构审计汇总（主控 + GPT-5.2）

## 审计方
- 主控 (Claude): 逐函数精读 ✅
- GPT-5.2: 缠论108课逐条对照 ✅ (6022 tokens输出)
- Gemini: relay未连接 ❌

## 合并偏差清单（去重后，按严重度排序）

### P0: 必须修复

| ID | 偏差 | 涉及函数 | 两方共识 |
|----|------|----------|----------|
| D1 | 中枢无状态机：滑动窗口式，无延伸/离开/回试 | _update_pivots | ✅ 一致 |
| D2 | 3B/3S 无"离开段"结构确认：仅检查价格>ZG | _check_signal | ✅ 一致 |
| D3 | 2B/2S 背驰未绑定同级别走势段力度比较 | _check_signal | ✅ 一致 |
| D4 | 包含方向初始默认向上(dir=0→1) | _process_inclusion | ✅ 一致 |

### P1: 建议修复

| ID | 偏差 | 涉及函数 | 两方共识 |
|----|------|----------|----------|
| D5 | 15m过滤仅diff>dea，不是结构联立 | _check_signal | ✅ 一致 |
| D6 | pivot_valid_range=6 工程窗口非结构定义 | _check_signal | ✅ 一致 |
| D7 | min_bi_gap=4 固定硬编码 | _process_bi | ✅ 一致 |
| D8 | OR模式背驰条件过宽(div_mode=1) | _eval_div_condition | GPT: P1, 主控: P1 |

### P2: 可接受

| ID | 偏差 | 备注 |
|----|------|------|
| D9 | ATR止损无结构含义 | 工程妥协，但应叠加结构止损 |
| D10 | 笔确认缺少状态管理 | 简化可接受 |

## 修复优先级决策

基于 **iter4 教训**（中枢状态机效果有限+113，做空灾难，全局降频伤趋势）：

| 优先级 | ID | 改动 | iter4经验 | 预期收益 |
|--------|----|----|-----------|----------|
| 1 | D4 | 包含方向修正 | 未尝试 | ⭐⭐⭐ |
| 2 | D1+D2 | 中枢状态机+离开段确认 | iter4 B14仅+113(太简) | ⭐⭐⭐⭐⭐(需更完整实现) |
| 3 | D3 | 背驰绑定走势段 | iter4 AND模式失败(太严) | ⭐⭐⭐ |
| 4 | D5 | 15m结构联立替代MACD | 未尝试 | ⭐⭐⭐⭐ |
| 5 | D8 | OR→更精确的背驰条件 | iter4 AND全FAIL | ⭐⭐ |

## Phase 1 决策门
- [x] 偏差清单输出 ✅
- [x] 两方审计一致 ✅
- [x] 修复vs保留决策 ✅
→ 进入 Phase 2 失败模式分解 + Phase 3 提取修复策略
